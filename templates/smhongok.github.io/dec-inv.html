<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Gradient-free Decoder Inversion in Latent Diffusion Models | Seongmin Hong</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="Gradient-free Decoder Inversion in Latent Diffusion Models" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="I am currently a Ph.D. candidate at the Intelligent Computational Imaging Lab in the Department of Electrical and Computer Engineering at Seoul National University. I graduated from the same department in 2020 and decided to continue my research journey in pursuit of a doctoral degree." />
<meta property="og:description" content="I am currently a Ph.D. candidate at the Intelligent Computational Imaging Lab in the Department of Electrical and Computer Engineering at Seoul National University. I graduated from the same department in 2020 and decided to continue my research journey in pursuit of a doctoral degree." />
<link rel="canonical" href="dec-inv.html" />
<meta property="og:url" content="https://smhongok.github.io/dec-inv.html" />
<meta property="og:site_name" content="Seongmin Hong" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Gradient-free Decoder Inversion in Latent Diffusion Models" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"I am currently a Ph.D. candidate at the Intelligent Computational Imaging Lab in the Department of Electrical and Computer Engineering at Seoul National University. I graduated from the same department in 2020 and decided to continue my research journey in pursuit of a doctoral degree.","headline":"Gradient-free Decoder Inversion in Latent Diffusion Models","url":"https://smhongok.github.io/dec-inv.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="assets/main.css"><link type="application/atom+xml" rel="alternate" href="https://smhongok.github.io/feed.xml" title="Seongmin Hong" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="https://smhongok.github.io/">Seongmin Hong</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="https://smhongok.github.io/">Seongmin Hong</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <h2 id="gradient-free-decoder-inversion-in-latent-diffusion-models"><center>Gradient-free Decoder Inversion in Latent Diffusion Models</center></h2>

<h4 id="-seongmin-hong1-suh-yoon-jeon1-kyeonghyun-lee1-ernestkryu2-se-young-chun13"><center> <a href="dec-inv.html">Seongmin Hong</a><sup>1</sup>, <a href="https://www.linkedin.com/in/suhyoonjeon">Suh Yoon Jeon</a><sup>1</sup>, <a href="https://www.linkedin.com/in/khlee0192">Kyeonghyun Lee</a><sup>1</sup>, <a href="https://ernestryu.com/">Ernest K. Ryu</a><sup>2</sup>, <a href="https://icl.snu.ac.kr/pi">Se Young Chun</a><sup>1,3</sup></center></h4>

<center>
<sup>1</sup>Dept. of Electrical and Computer Engineering, <sup>3</sup>INMC &amp; IPAI, Seoul National University     
<br />
<sup>2</sup>Dept. of Mathematics, University of California, Los Angeles   
<br />
</center>

<h3 id="neurips-2024-"><center><strong>NeurIPS 2024</strong> </center></h3>

<h4 id="paper-arxiv-video-github-bibtex"><center>[<a href="https://proceedings.neurips.cc/paper_files/paper/2024/hash/970f59b22f4c72aec75174aae63c7459-Abstract-Conference.html">Paper</a>] [<a href="http://arxiv.org/abs/2409.18442">arXiv</a>] [<a href="https://recorder-v3.slideslive.com/#/share?share=94209&amp;s=10070c25-7055-403c-bd99-5bfc52ab749d">video</a>] [<a href="https://github.com/smhongok/dec-inv">github</a>] [<a href="dec-inv.html#bibtex">bibTeX</a>]</center></h4>

<p><br /></p>

<p><br /></p>

<p><br /></p>

<h2 id="main-idea-gif"><center>Main Idea (gif)</center></h2>

<p align="center">
    <img src="files/hong2024decinv/dec-inv.gif" alt="GIF file" />
</p>
<p><br /><br /><br /><br /><br /></p>

<h2 id="main-contribution"><center>Main Contribution</center></h2>

<p align="center">
    <img src="files/hong2024decinv/10p.gif" alt="GIF file" />
</p>

<p><br /><br /><br /><br /><br /></p>

<h2 id="-convergence-analysis-"><center> Convergence Analysis </center></h2>

<p><br /></p>

<p align="center">
    <figure>
        <img src="files/hong2024decinv/thm1.png" alt="GIF file" />
    </figure>
</p>

<center>Our method provably converges.</center>

<p><br /></p>

<p><br /></p>

<p><br /></p>

<p align="center">
    <figure>
        <img src="files/hong2024decinv/km.png" alt="png file" />
    </figure>
</p>

<center>Moreover, with momentum (inertial KM iteration),</center>

<p><br /></p>

<p><br /></p>

<p align="center">
    <figure>
        <img src="files/hong2024decinv/thm2.png" alt="png file" />
    </figure>
</p>

<center>It also provably converges.</center>

<p><br /></p>

<p><br /></p>

<p><br /></p>

<h2 id="-results-"><center> Results </center></h2>

<p><br /></p>

<p align="center">
    <figure>
        <img src="files/hong2024decinv/results.png" alt="png file" />
    </figure>
</p>

<p>Our gradient-free decoder inversion is:</p>

<ul>
  <li>
    <p><strong>Fast</strong>: up to 5× faster, 1.89 s vs 9.51 s to achieve -16.4 dB (InstaFlow)</p>
  </li>
  <li>
    <p><strong>Accurate</strong>: up to 2.3 dB lower, -21.37 dB vs -19.06 dB in 25.1 s (LaVie)</p>
  </li>
  <li>
    <p><strong>Memory-efficient</strong>: up to <em>89%</em> can be saved, 7.13 GB vs 64.7 GB (Lavie)</p>
  </li>
  <li>
    <p><strong>Precision-flexible</strong>: 16-bit vs 32-bit (all)</p>
  </li>
</ul>

<p><br /></p>

<p><br /></p>

<p><br /></p>

<p><br /></p>

<h2 id="poster"><center>Poster</center></h2>

<p align="center">
    <figure>
        <a href="files/hong2024decinv/poster.png" download="poster.png">
            <img src="files/hong2024decinv/poster.png" alt="png file" style="max-width: 100%; height: auto;" />
        </a>
        <figcaption>Click the image to download the poster</figcaption>
    </figure>
</p>

<p><br /></p>

<p><br /></p>

<p><br /></p>

<p><br /></p>

<h2 id="abstract"><center>Abstract</center></h2>

<p>In latent diffusion models (LDMs), denoising diffusion process efficiently takes place on latent space whose dimension is lower than that of pixel space. Decoder is typically used to transform the representation in latent space to that in pixel space. While a decoder is assumed to have an encoder as an accurate inverse, exact encoder-decoder pair rarely exists in practice even though applications often require precise inversion of decoder. Prior works for decoder inversion in LDMs employed gradient descent inspired by inversions of generative adversarial networks. However, gradient-based methods require larger GPU memory and longer computation time for larger latent space. For example, recent video LDMs can generate more than 16 frames, but GPUs with 24 GB memory can only perform gradient-based decoder inversion for 4 frames. Here, we propose an efficient gradient-free decoder inversion for LDMs, which can be applied to diverse latent models. Theoretical convergence property of our proposed inversion has been investigated not only for the forward step method, but also for the inertial Krasnoselskii-Mann (KM) iterations under mild assumption on cocoercivity that is satisfied by recent LDMs. Our proposed gradient-free method with Adam optimizer and learning rate scheduling significantly reduced computation time and memory usage over prior gradient-based methods and enabled efficient computation in applications such as noise-space watermarking while achieving comparable error levels.</p>

<p><br /><br /></p>

<p><br /><br /><br /></p>

<p><a name="bibtex"></a></p>

<h2 id="bibtex"><center>BibTeX</center></h2>

<pre> 
@inproceedings{hong2024gradient,
 author = {Hong, Seongmin and Jeon, Suh Yoon and Lee, Kyeonghyun and Ryu, Ernest K. and Chun, Young},
 booktitle = {Advances in Neural Information Processing Systems},
 editor = {A. Globerson and L. Mackey and D. Belgrave and A. Fan and U. Paquet and J. Tomczak and C. Zhang},
 pages = {82982--83007},
 publisher = {Curran Associates, Inc.},
 title = {Gradient-free Decoder Inversion in Latent Diffusion Models},
 url = {https://proceedings.neurips.cc/paper_files/paper/2024/file/970f59b22f4c72aec75174aae63c7459-Paper-Conference.pdf},
 volume = {37},
 year = {2024}
}
</pre>


      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Seongmin Hong</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Seongmin Hong</li><li><a class="u-email" href="mailto:smhongok@snu.ac.kr">smhongok@snu.ac.kr</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/smhongok"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">smhongok</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>I am currently a Ph.D. candidate at the Intelligent Computational Imaging Lab in the Department of Electrical and Computer Engineering at Seoul National University. I graduated from the same department in 2020 and decided to continue my research journey in pursuit of a doctoral degree.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
